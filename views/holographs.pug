extends layout

block content
  // Unbuffered server-side code to define search results
  -
    let results = [
      { holograph_name: "Starlight Symphony", creator: "Avery Johnson", edition_number: 1 },
      { holograph_name: "Dreamscape", creator: "Elena Rodriguez", edition_number: 2 },
      { holograph_name: "Cosmic Illusion", creator: "Kai Chen", edition_number: 3 }
    ]

  // Outermost container with class container-fluid
  .container-fluid
    // Middle div with class row
    .row
      // Unbuffered server-side code to iterate over results
      each result, index in results
        // Each result object is placed within its own div with class col-md-4
        .col-md-4
          .result
            // Inner div for each object with class col-sm-2
            .col-sm-2
              p
                strong Holograph Name:
                span #{result.holograph_name}
              p
                strong Creator:
                span #{result.creator}
              p
                strong Edition Number:
                span #{result.edition_number}
              // Use event delegation with data attributes
              button(type="button" class="buy-button" data-index=index) Buy

  script.
    // Function to handle buy button click
    document.addEventListener('DOMContentLoaded', function() {
      // Add click event listener to all elements with class .buy-button
      document.querySelectorAll('.buy-button').forEach(button => {
        button.addEventListener('click', function() {
          // Retrieve the index from the data-index attribute
          const index = parseInt(this.dataset.index);
          // Alert with the purchased holograph name
          alert(`You purchased holograph ${results[index].holograph_name}.`);
        });
      });
    });
